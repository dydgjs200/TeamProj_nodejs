<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      integrity="sha512-BKTRJSBv9tQDe+qZqRr9LJQktGMxwwkIs6mH3l5x0epjQQ2glzB6tDM1gJnbxoJFqP4iTVgfk4DSbsnmRvhVw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    
    <!-- 테이블 클릭 할 시 링크이동을 위한 스타일 -->
    <style>
      table tr {
        cursor: pointer;
      }
    </style>

    <link rel="stylesheet" href="/static/css/component.css" />
    <link rel="stylesheet" href="/static/css/borad.css" />
    <link rel="stylesheet" href="/static/css/sidebarHeader.css" />
    <title>커뮤니티 게시판</title>
  </head>
  <body id="add_body">
    <div>
      <form>
        <div class="add-C">
          <button type="button" onclick="writeCommunity()">글쓰기</button>
        </div>
      </form>
      <table>
        <tr>
          <th class="th-number">번호</th>
          <th class="th-title">제목</th>
          <th class="th-writer">글쓴이</th>
          <th class="th-check">조회</th>
          <th class="th-time">작성일</th>
        </tr>
        <% communityData.forEach((data) => { %>
          <tr onclick="detailCommunityPage('<%= data.number %>')">
              <td><%= data.number %></td>
              <td><%= data.title %></td>
              <td><%= data.userid %></td>
              <td><%= data.view %></td>
              <td><%= data.date %></td>
          </tr>
      <% }); %>
      </table>
      <form>
        <div class="add-C">
          <button type="button" onclick="writeCommunity()">글쓰기</button>
        </div>
      </form>
      <div class="paging" id="paging">
        <!-- 페이징 추가 될 공간 -->
      </div>

      <!-- 검색 영역 추가 -->
      <div id="search-area">
        <select name="search-type" id="search-type">
          <option value="title-content">제목+내용</option>
          <option value="title">제목</option>
          <option value="content">내용</option>
          <option value="writer">글쓴이</option>
        </select>
        <input
          type="text"
          id="search-input"
          placeholder="검색어를 입력하세요"
        />
        <button id="search-button" onclick="searchCommunity()">검색</button>
      </div>
    </div>
    

    <script src="/static/javaScript/community.js"></script>
    <title>community</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="/static/css/header.css" />
    <link rel="stylesheet" href="/static/css/component.css" />

    <script>
      // 글 조회 시 세부 페이지 이동
      function detailCommunityPage(postNumber){
        axios({
          method: "post",
          url: "/detailCommunityPage",
          data: { number: parseInt(postNumber) }, // 객체 형태로 전달
        }).then((result) => {
          location.href = "/readCommunity?number=" + JSON.stringify(result.data.number);
        })
      }

      // 글쓰기 페이지 이동
      function writeCommunity() {
        if(!'<%= locals.userid%>'){
          return swal("로그인이 필요합니다.", "", "error").then(function () {
            location.href = "/login";
          });
        }

        window.location.href = "/writeCommunity";
      }

    </script>
  </head>
  <body>

    <%- include("../component/header")%>

    <main class="container"></main>
  </body>
</html>
